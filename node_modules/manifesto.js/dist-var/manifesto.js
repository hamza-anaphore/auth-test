var manifesto=function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),n(r(9)),n(r(10)),n(r(11)),n(r(12)),n(r(13)),n(r(14)),n(r(15)),n(r(16)),n(r(17)),n(r(31)),n(r(33)),n(r(34)),n(r(35)),n(r(36)),n(r(37)),n(r(40)),n(r(41)),n(r(42)),n(r(43)),n(r(44)),n(r(45)),n(r(46)),n(r(47)),n(r(48)),n(r(49)),n(r(50)),n(r(51)),n(r(52)),n(r(3))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.BOOKMARKING="oa:bookmarking",t.CLASSIFYING="oa:classifying",t.COMMENTING="oa:commenting",t.DESCRIBING="oa:describing",t.EDITING="oa:editing",t.HIGHLIGHTING="oa:highlighting",t.IDENTIFYING="oa:identifying",t.LINKING="oa:linking",t.MODERATING="oa:moderating",t.PAINTING="sc:painting",t.QUESTIONING="oa:questioning",t.REPLYING="oa:replying",t.TAGGING="oa:tagging",t.TRANSCRIBING="oad:transcribing"}(e.AnnotationMotivation||(e.AnnotationMotivation={})),function(t){t.AUTO_ADVANCE="auto-advance",t.CONTINUOUS="continuous",t.FACING_PAGES="facing-pages",t.HIDDEN="hidden",t.INDIVIDUALS="individuals",t.MULTI_PART="multi-part",t.NO_NAV="no-nav",t.NON_PAGED="non-paged",t.PAGED="paged",t.REPEAT="repeat",t.SEQUENCE="sequence",t.THUMBNAIL_NAV="thumbnail-nav",t.TOGETHER="together",t.UNORDERED="unordered"}(e.Behavior||(e.Behavior={})),function(t){t.CANVAS="canvas",t.CHOICE="choice",t.OA_CHOICE="oa:choice",t.CONTENT_AS_TEXT="contentastext",t.DATASET="dataset",t.DOCUMENT="document",t.IMAGE="image",t.MODEL="model",t.MOVING_IMAGE="movingimage",t.PDF="pdf",t.PHYSICAL_OBJECT="physicalobject",t.SOUND="sound",t.TEXT="text",t.TEXTUALBODY="textualbody",t.VIDEO="video"}(e.ExternalResourceType||(e.ExternalResourceType={})),function(t){t.ANNOTATION="annotation",t.CANVAS="canvas",t.COLLECTION="collection",t.MANIFEST="manifest",t.RANGE="range",t.SEQUENCE="sequence"}(e.IIIFResourceType||(e.IIIFResourceType={})),function(t){t.AUDIO_MP4="audio/mp4",t.CORTO="application/corto",t.DICOM="application/dicom",t.DRACO="application/draco",t.EPUB="application/epub+zip",t.GLB="model/gltf-binary",t.GLTF="model/gltf+json",t.IIIF_PRESENTATION_2='application/ld+json;profile="http://iiif.io/api/presentation/2/context.json"',t.IIIF_PRESENTATION_3='application/ld+json;profile="http://iiif.io/api/presentation/3/context.json"',t.JPG="image/jpeg",t.M3U8="application/vnd.apple.mpegurl",t.MP3="audio/mp3",t.MPEG_DASH="application/dash+xml",t.OBJ="text/plain",t.OPF="application/oebps-package+xml",t.PDF="application/pdf",t.PLY="application/ply",t.THREEJS="application/vnd.threejs+json",t.USDZ="model/vnd.usd+zip",t.VIDEO_MP4="video/mp4",t.WEBM="video/webm"}(e.MediaType||(e.MediaType={})),function(t){t.DOC="application/msword",t.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",t.PDF="application/pdf"}(e.RenderingFormat||(e.RenderingFormat={})),function(t){t.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",t.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",t.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",t.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",t.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",t.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",t.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",t.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",t.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",t.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",t.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",t.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",t.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",t.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",t.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",t.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",t.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",t.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",t.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",t.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",t.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",t.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",t.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",t.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",t.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",t.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",t.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",t.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",t.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",t.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",t.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",t.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",t.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",t.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",t.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",t.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",t.SEARCH_0="http://iiif.io/api/search/0/search",t.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",t.SEARCH_1="http://iiif.io/api/search/1/search",t.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",t.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",t.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",t.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",t.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",t.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",t.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(e.ServiceProfile||(e.ServiceProfile={})),function(t){t.BOTTOM_TO_TOP="bottom-to-top",t.LEFT_TO_RIGHT="left-to-right",t.RIGHT_TO_LEFT="right-to-left",t.TOP_TO_BOTTOM="top-to-bottom"}(e.ViewingDirection||(e.ViewingDirection={})),function(t){t.CONTINUOUS="continuous",t.INDIVIDUALS="individuals",t.NON_PAGED="non-paged",t.PAGED="paged",t.TOP="top"}(e.ViewingHint||(e.ViewingHint={}))},function(t,e,r){var n=r(21).Symbol;t.exports=n},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=r(1),s=r(38);r(39);var u=function(){function t(){}return t.getMediaType=function(t){return(t=(t=t.toLowerCase()).split(";")[0]).trim()},t.getImageQuality=function(t){return t===a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1||t===a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2||t===a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1||t===a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2||t===a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1||t===a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2||t===a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1||t===a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2||t===a.ServiceProfile.IMAGE_1_LEVEL_1||t===a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1||t===a.ServiceProfile.IMAGE_1_LEVEL_2||t===a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2?"native":"default"},t.getInexactLocale=function(t){return-1!==t.indexOf("-")?t.substr(0,t.indexOf("-")):t},t.getLocalisedValue=function(t,e){if(!Array.isArray(t))return t;for(var r=0;r<t.length;r++){var n=t[r];if(e===n["@language"])return n["@value"]}var i=e.substr(0,e.indexOf("-"));for(r=0;r<t.length;r++){var o=t[r];if(o["@language"]===i)return o["@value"]}return null},t.generateTreeNodeIds=function(e,r){var n;void 0===r&&(r=0),n=e.parentNode?e.parentNode.id+"-"+r:"0",e.id=n;for(var i=0;i<e.nodes.length;i++){var o=e.nodes[i];t.generateTreeNodeIds(o,i)}},t.normaliseType=function(t){return-1!==(t=(t||"").toLowerCase()).indexOf(":")?t.split(":")[1]:t},t.normaliseUrl=function(t){return-1!==(t=t.substr(t.indexOf("://"))).indexOf("#")&&(t=t.split("#")[0]),t},t.normalisedUrlsMatch=function(e,r){return t.normaliseUrl(e)===t.normaliseUrl(r)},t.isImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},t.isLevel0ImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_0)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0))},t.isLevel1ImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_1)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1))},t.isLevel2ImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_LEVEL_2)||t.normalisedUrlsMatch(e,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},t.parseManifest=function(t,e){return o.Deserialiser.parse(t,e)},t.checkStatus=function(t){if(t.ok)return t;var e=new Error(t.statusText);return e.response=t,Promise.reject(e)},t.loadManifest=function(e){return new Promise((function(r){fetch(e).then(t.checkStatus).then((function(t){return t.json()})).then((function(t){r(t)}))}))},t.loadExternalResourcesAuth1=function(e,r,n,i,o,a,s,u){return new Promise((function(c,l){var p=e.map((function(e){return t.loadExternalResourceAuth1(e,r,n,i,o,a,s,u)}));Promise.all(p).then((function(){c(e)})).catch((function(t){l(t)}))}))},t.loadExternalResourceAuth1=function(e,r,o,a,u,c,l,p){return n(this,void 0,void 0,(function(){var n;return i(this,(function(i){switch(i.label){case 0:return[4,a(e)];case 1:return(n=i.sent())?[4,e.getData(n)]:[3,6];case 2:return i.sent(),e.status!==s.OK?[3,3]:[2,e];case 3:return[4,t.doAuthChain(e,r,o,u,c,l,p)];case 4:i.sent(),i.label=5;case 5:if(e.status===s.OK||e.status===s.MOVED_TEMPORARILY)return[2,e];throw t.createAuthorizationFailedError();case 6:return[4,e.getData()];case 7:return i.sent(),e.status!==s.MOVED_TEMPORARILY&&e.status!==s.UNAUTHORIZED?[3,9]:[4,t.doAuthChain(e,r,o,u,c,l,p)];case 8:i.sent(),i.label=9;case 9:if(e.status===s.OK||e.status===s.MOVED_TEMPORARILY)return[2,e];throw t.createAuthorizationFailedError()}}))}))},t.doAuthChain=function(e,r,o,a,u,c,l){return n(this,void 0,void 0,(function(){var n,p,f,h,_,g,d,v;return i(this,(function(i){switch(i.label){case 0:return e.isAccessControlled()?((n=e.externalService)&&(n.options=e.options),(p=e.kioskService)&&(p.options=e.options),(f=e.clickThroughService)&&(f.options=e.options),(h=e.loginService)&&(h.options=e.options),e.isResponseHandled||e.status!==s.MOVED_TEMPORARILY?[3,2]:[4,c(e)]):[2,e];case 1:return i.sent(),[2,e];case 2:return _=null,g=null,(_=n)?(g=_,[4,t.attemptResourceWithToken(e,o,_)]):[3,4];case 3:return i.sent(),[2,e];case 4:return(_=p)?(g=_,(d=r(_))?[4,a(d)]:[3,7]):[3,7];case 5:return i.sent(),[4,t.attemptResourceWithToken(e,o,_)];case 6:return i.sent(),[2,e];case 7:return(_=f)?(g=_,[4,u(e,_)]):[3,11];case 8:return(v=i.sent())?[4,a(v)]:[3,11];case 9:return i.sent(),[4,t.attemptResourceWithToken(e,o,_)];case 10:return i.sent(),[2,e];case 11:return(_=h)?(g=_,[4,u(e,_)]):[3,15];case 12:return(v=i.sent())?[4,a(v)]:[3,15];case 13:return i.sent(),[4,t.attemptResourceWithToken(e,o,_)];case 14:return i.sent(),[2,e];case 15:return g&&l(e,g),[2]}}))}))},t.attemptResourceWithToken=function(t,e,r){return n(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:return(n=r.getService(a.ServiceProfile.AUTH_1_TOKEN))?[4,e(t,n)]:[3,3];case 1:return(o=i.sent())&&o.accessToken?[4,t.getData(o)]:[3,3];case 2:return i.sent(),[2,t];case 3:return[2]}}))}))},t.loadExternalResourcesAuth09=function(e,r,n,i,o,a,s,u,c,l){return new Promise((function(p,f){var h=e.map((function(e){return t.loadExternalResourceAuth09(e,r,n,i,o,a,s,u,c,l)}));Promise.all(h).then((function(){p(e)})).catch((function(t){f(t)}))}))},t.loadExternalResourceAuth09=function(e,r,n,i,o,a,u,c,l,p){return new Promise((function(f,h){p&&p.pessimisticAccessControl?e.getData().then((function(){e.isAccessControlled()?e.clickThroughService?(f(n(e)),f(i(e))):o(e).then((function(){a(e,!0).then((function(r){e.getData(r).then((function(){f(l(e))})).catch((function(e){h(t.createInternalServerError(e))}))})).catch((function(e){h(t.createInternalServerError(e))}))})).catch((function(e){h(t.createInternalServerError(e))})):f(e)})).catch((function(e){h(t.createInternalServerError(e))})):c(e,r).then((function(p){p?e.getData(p).then((function(){e.status===s.OK?f(l(e)):t.authorize(e,r,n,i,o,a,u,c).then((function(){f(l(e))})).catch((function(e){h(t.createAuthorizationFailedError())}))})).catch((function(e){h(t.createAuthorizationFailedError())})):t.authorize(e,r,n,i,o,a,u,c).then((function(){f(l(e))})).catch((function(e){h(t.createAuthorizationFailedError())}))})).catch((function(e){h(t.createAuthorizationFailedError())}))}))},t.createError=function(t,e){var r=new Error;return r.message=e,r.name=String(t),r},t.createAuthorizationFailedError=function(){return t.createError(o.StatusCode.AUTHORIZATION_FAILED,"Authorization failed")},t.createRestrictedError=function(){return t.createError(o.StatusCode.RESTRICTED,"Restricted")},t.createInternalServerError=function(e){return t.createError(o.StatusCode.INTERNAL_SERVER_ERROR,e)},t.authorize=function(e,r,n,i,o,a,u,c){return new Promise((function(l,p){e.getData().then((function(){e.isAccessControlled()?c(e,r).then((function(c){c?e.getData(c).then((function(){e.status===s.OK?l(e):t.showAuthInteraction(e,r,n,i,o,a,u,l,p)})).catch((function(e){p(t.createInternalServerError(e))})):a(e,!1).then((function(c){c?u(e,c,r).then((function(){e.getData(c).then((function(){e.status===s.OK?l(e):t.showAuthInteraction(e,r,n,i,o,a,u,l,p)})).catch((function(e){p(t.createInternalServerError(e))}))})).catch((function(e){p(t.createInternalServerError(e))})):t.showAuthInteraction(e,r,n,i,o,a,u,l,p)}))})).catch((function(e){p(t.createInternalServerError(e))})):l(e)}))}))},t.showAuthInteraction=function(e,r,n,i,o,a,u,c,l){e.status!==s.MOVED_TEMPORARILY||e.isResponseHandled?e.clickThroughService&&!e.isResponseHandled?n(e).then((function(){a(e,!0).then((function(n){u(e,n,r).then((function(){e.getData(n).then((function(){c(e)})).catch((function(e){l(t.createInternalServerError(e))}))})).catch((function(e){l(t.createInternalServerError(e))}))})).catch((function(e){l(t.createInternalServerError(e))}))})):o(e).then((function(){a(e,!0).then((function(n){u(e,n,r).then((function(){e.getData(n).then((function(){c(e)})).catch((function(e){l(t.createInternalServerError(e))}))})).catch((function(e){l(t.createInternalServerError(e))}))})).catch((function(e){l(t.createInternalServerError(e))}))})):c(e)},t.getService=function(t,e){for(var r=this.getServices(t),n=0;n<r.length;n++){var i=r[n];if(i.getProfile()===e)return i}return null},t.getResourceById=function(e,r){return t.traverseAndFind(e.__jsonld,"@id",r)},t.traverseAndFind=function(e,r,n){if(e.hasOwnProperty(r)&&e[r]===n)return e;for(var i=0;i<Object.keys(e).length;i++)if("object"==typeof e[Object.keys(e)[i]]){var o=t.traverseAndFind(e[Object.keys(e)[i]],r,n);if(null!=o)return o}},t.getServices=function(t){var e,r=[];if(!(e=t.__jsonld?t.__jsonld.service:t.service))return r;Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var i=e[n];if("string"==typeof i){var a=this.getResourceById(t.options.resource,i);a&&r.push(new o.Service(a.__jsonld||a,t.options))}else r.push(new o.Service(i,t.options))}return r},t.getTemporalComponent=function(t){var e=/t=([^&]+)/g.exec(t),r=null;return e&&e[1]&&(r=e[1].split(",")),r},t}();e.Utils=u},function(t,e,r){var n=r(19),i=r(20);t.exports=function t(e,r,o,a,s){var u=-1,c=e.length;for(o||(o=i),s||(s=[]);++u<c;){var l=e[u];r>0&&o(l)?r>1?t(l,r-1,o,a,s):n(s,l):a||(s[s.length]=l)}return s}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,r){"use strict";r.r(e),e.default=function(t,e){return e=e||{},new Promise((function(r,n){var i=new XMLHttpRequest,o=[],a=[],s={},u=function(){return{ok:2==(i.status/100|0),statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(JSON.parse(i.responseText))},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:u,headers:{keys:function(){return o},entries:function(){return a},get:function(t){return s[t.toLowerCase()]},has:function(t){return t.toLowerCase()in s}}}};for(var c in i.open(e.method||"get",t,!0),i.onload=function(){i.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(t,e,r){o.push(e=e.toLowerCase()),a.push([e,r]),s[e]=s[e]?s[e]+","+r:r})),r(u())},i.onerror=n,i.withCredentials="include"==e.credentials,e.headers)i.setRequestHeader(c,e.headers[c]);i.send(e.body||null)}))}},function(t,e,r){t.exports=r(8)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(0));var n=r(3);e.loadManifest=function(t){return n.Utils.loadManifest(t)},e.parseManifest=function(t,e){return n.Utils.parseManifest(t,e)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.__jsonld=t,this.context=this.getProperty("context"),this.id=this.getProperty("id")}return t.prototype.getProperty=function(t){var e=null;return this.__jsonld&&((e=this.__jsonld[t])||(e=this.__jsonld["@"+t])),e},t}();e.JSONLDResource=n},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=r(1),s=function(t){function e(e,r){var n=t.call(this,e)||this;return n.options=r,n}return i(e,t),e.prototype.getIIIFResourceType=function(){return o.Utils.normaliseType(this.getProperty("type"))},e.prototype.getLabel=function(){var t=this.getProperty("label");return t?o.PropertyValue.parse(t,this.options.locale):new o.PropertyValue([],this.options.locale)},e.prototype.getDefaultLabel=function(){return this.getLabel().getValue(this.options.locale)},e.prototype.getMetadata=function(){var t=this.getProperty("metadata"),e=[];if(!t)return e;for(var r=0;r<t.length;r++){var n=t[r],i=new o.LabelValuePair(this.options.locale);i.parse(n),e.push(i)}return e},e.prototype.getRendering=function(t){for(var e=this.getRenderings(),r=0;r<e.length;r++){var n=e[r];if(n.getFormat()===t)return n}return null},e.prototype.getRenderings=function(){var t,e=[];if(!(t=this.__jsonld?this.__jsonld.rendering:this.rendering))return e;Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var n=t[r];e.push(new o.Rendering(n,this.options))}return e},e.prototype.getService=function(t){return o.Utils.getService(this,t)},e.prototype.getServices=function(){return o.Utils.getServices(this)},e.prototype.getThumbnail=function(){var t=this.getProperty("thumbnail");return Array.isArray(t)&&(t=t[0]),t?new o.Thumbnail(t,this.options):null},e.prototype.isAnnotation=function(){return this.getIIIFResourceType()===a.IIIFResourceType.ANNOTATION},e.prototype.isCanvas=function(){return this.getIIIFResourceType()===a.IIIFResourceType.CANVAS},e.prototype.isCollection=function(){return this.getIIIFResourceType()===a.IIIFResourceType.COLLECTION},e.prototype.isManifest=function(){return this.getIIIFResourceType()===a.IIIFResourceType.MANIFEST},e.prototype.isRange=function(){return this.getIIIFResourceType()===a.IIIFResourceType.RANGE},e.prototype.isSequence=function(){return this.getIIIFResourceType()===a.IIIFResourceType.SEQUENCE},e}(o.JSONLDResource);e.ManifestResource=s},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=function(t){function e(e,r){return t.call(this,e,r)||this}return i(e,t),e.prototype.getFormat=function(){var t=this.getProperty("format");return t?t.toLowerCase():null},e.prototype.getResources=function(){var t=[];if(!this.__jsonld.resources)return t;for(var e=0;e<this.__jsonld.resources.length;e++){var r=this.__jsonld.resources[e],n=new o.Annotation(r,this.options);t.push(n)}return t},e.prototype.getType=function(){var t=this.getProperty("type");return t?o.Utils.normaliseType(t):null},e.prototype.getWidth=function(){return this.getProperty("width")},e.prototype.getHeight=function(){return this.getProperty("height")},e.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},e.prototype.getMaxHeight=function(){return this.getProperty("maxHeight")?null:this.getMaxWidth()},e}(o.ManifestResource);e.Resource=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=r(1),s=function(t){function e(e,r){var n=t.call(this,e,r)||this;n.index=-1,n.isLoaded=!1;var i={defaultLabel:"-",locale:"en-GB",resource:n,pessimisticAccessControl:!1};return n.options=Object.assign(i,r),n}return i(e,t),e.prototype.getAttribution=function(){var t=this.getProperty("attribution");return t?o.PropertyValue.parse(t,this.options.locale):new o.PropertyValue([],this.options.locale)},e.prototype.getDescription=function(){var t=this.getProperty("description");return t?o.PropertyValue.parse(t,this.options.locale):new o.PropertyValue([],this.options.locale)},e.prototype.getHomepage=function(){var t=this.getProperty("homepage");return t?"string"==typeof t?t:(Array.isArray(t)&&t.length&&(t=t[0]),t["@id"]||t.id):null},e.prototype.getIIIFResourceType=function(){return o.Utils.normaliseType(this.getProperty("type"))},e.prototype.getLogo=function(){var t=this.getProperty("logo");return t?"string"==typeof t?t:(Array.isArray(t)&&t.length&&(t=t[0]),t["@id"]||t.id):null},e.prototype.getLicense=function(){return o.Utils.getLocalisedValue(this.getProperty("license"),this.options.locale)},e.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},e.prototype.getRelated=function(){return this.getProperty("related")},e.prototype.getSeeAlso=function(){return this.getProperty("seeAlso")},e.prototype.getTrackingLabel=function(){var t=this.getService(a.ServiceProfile.TRACKING_EXTENSIONS);return t?t.getProperty("trackingLabel"):""},e.prototype.getDefaultTree=function(){return this.defaultTree=new o.TreeNode("root"),this.defaultTree.data=this,this.defaultTree},e.prototype.getRequiredStatement=function(){var t=null,e=this.getProperty("requiredStatement");if(e)(t=new o.LabelValuePair(this.options.locale)).parse(e);else{var r=this.getAttribution();r&&((t=new o.LabelValuePair(this.options.locale)).value=r)}return t},e.prototype.isCollection=function(){return this.getIIIFResourceType()===a.IIIFResourceType.COLLECTION},e.prototype.isManifest=function(){return this.getIIIFResourceType()===a.IIIFResourceType.MANIFEST},e.prototype.load=function(){var t=this;return new Promise((function(e){if(t.isLoaded)e(t);else{var r=t.options;r.navDate=t.getNavDate();var n=t.__jsonld.id;n||(n=t.__jsonld["@id"]),o.Utils.loadManifest(n).then((function(n){t.parentLabel=t.getLabel().getValue(r.locale);var i=o.Deserialiser.parse(n,r);(t=Object.assign(t,i)).index=r.index,e(t)}))}}))},e}(o.ManifestResource);e.IIIFResource=s},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=function(t){function e(e,r){return t.call(this,e,r)||this}return i(e,t),e.prototype.getBody=function(){var t=[],e=this.getProperty("body");if(e)if(Array.isArray(e))for(var r=0;r<e.length;r++){if((a=e[r]).items)for(var n=0;n<a.items.length;n++){var i=a.items[n];t.push(new o.AnnotationBody(i,this.options))}else t.push(new o.AnnotationBody(a,this.options))}else if(e.items)for(r=0;r<e.items.length;r++){var a=e.items[r];t.push(new o.AnnotationBody(a,this.options))}else t.push(new o.AnnotationBody(e,this.options));return t},e.prototype.getMotivation=function(){var t=this.getProperty("motivation");return t||null},e.prototype.getOn=function(){return this.getProperty("on")},e.prototype.getTarget=function(){return this.getProperty("target")},e.prototype.getResource=function(){return new o.Resource(this.getProperty("resource"),this.options)},e}(o.ManifestResource);e.Annotation=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=function(t){function e(e,r){return t.call(this,e,r)||this}return i(e,t),e.prototype.getFormat=function(){var t=this.getProperty("format");return t?o.Utils.getMediaType(t):null},e.prototype.getType=function(){return this.getProperty("type")?o.Utils.normaliseType(this.getProperty("type")):null},e.prototype.getWidth=function(){return this.getProperty("width")},e.prototype.getHeight=function(){return this.getProperty("height")},e}(o.ManifestResource);e.AnnotationBody=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=function(t){function e(e,r,n){var i=t.call(this,r)||this;return i.label=e,i.options=n,i}return i(e,t),e.prototype.getIIIFResourceType=function(){return o.Utils.normaliseType(this.getProperty("type"))},e.prototype.getLabel=function(){return this.label},e.prototype.getResources=function(){var t=this;return this.getProperty("resources").map((function(e){return new o.Annotation(e,t.options)}))},e.prototype.load=function(){var t=this;return new Promise((function(e,r){if(t.isLoaded)e(t);else{var n=t.__jsonld.id;n||(n=t.__jsonld["@id"]),o.Utils.loadManifest(n).then((function(r){t.__jsonld=r,t.context=t.getProperty("context"),t.id=t.getProperty("id"),t.isLoaded=!0,e(t)})).catch(r)}}))},e}(o.JSONLDResource);e.AnnotationList=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,r){return t.call(this,e,r)||this}return i(e,t),e.prototype.getItems=function(){return this.getProperty("items")},e}(r(0).ManifestResource);e.AnnotationPage=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(0),s=r(18),u=r(30),c=function(t){function e(e,r){return t.call(this,e,r)||this}return i(e,t),e.prototype.getCanonicalImageUri=function(t){var e,r=null,n="default",i=t;if(this.externalResource&&this.externalResource.data&&this.externalResource.data["@id"])r=this.externalResource.data["@id"],i||(i=this.externalResource.data.width),this.externalResource.data["@context"]&&(this.externalResource.data["@context"].indexOf("/1.0/context.json")>-1||this.externalResource.data["@context"].indexOf("/1.1/context.json")>-1||this.externalResource.data["@context"].indexOf("/1/context.json")>-1)&&(n="native");else{var o=this.getImages();if(o&&o.length){var s=o[0].getResource(),u=s.getServices();if(i||(i=s.getWidth()),u.length){var c=u[0];r=c.id,n=a.Utils.getImageQuality(c.getProfile())}else if(i===s.getWidth())return s.id}if(!r){var l=this.getProperty("thumbnail");if(l){if("string"==typeof l)return l;if(l["@id"])return l["@id"];if(l.length)return l[0].id}}}return e=i+",",r&&r.endsWith("/")&&(r=r.substr(0,r.length-1)),[r,"full",e,0,n+".jpg"].join("/")},e.prototype.getMaxDimensions=function(){var t,e=null;return this.externalResource&&this.externalResource.data&&this.externalResource.data.profile&&(t=this.externalResource.data.profile,Array.isArray(t)&&(t=t.filter((function(t){return t.maxWidth}))[0])&&(e=new a.Size(t.maxWidth,t.maxHeight?t.maxHeight:t.maxWidth))),e},e.prototype.getContent=function(){var t=[],e=this.__jsonld.items||this.__jsonld.content;if(!e)return t;var r=null;if(e.length&&(r=new a.AnnotationPage(e[0],this.options)),!r)return t;for(var n=r.getItems(),i=0;i<n.length;i++){var o=n[i],s=new a.Annotation(o,this.options);t.push(s)}return t},e.prototype.getDuration=function(){return this.getProperty("duration")},e.prototype.getImages=function(){var t=[];if(!this.__jsonld.images)return t;for(var e=0;e<this.__jsonld.images.length;e++){var r=this.__jsonld.images[e],n=new a.Annotation(r,this.options);t.push(n)}return t},e.prototype.getIndex=function(){return this.getProperty("index")},e.prototype.getOtherContent=function(){var t=this,e=Array.isArray(this.getProperty("otherContent"))?this.getProperty("otherContent"):[this.getProperty("otherContent")],r=e.filter((function(t){return t&&(e=t["@type"],r="sc:AnnotationList","string"==typeof e&&"string"==typeof r&&e.toLowerCase()==e.toLowerCase());var e,r})).map((function(e,r){return new a.AnnotationList(e.label||"Annotation list "+r,e,t.options)})).map((function(t){return t.load()}));return Promise.all(r)},e.prototype.getWidth=function(){return this.getProperty("width")},e.prototype.getHeight=function(){return this.getProperty("height")},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},Object.defineProperty(e.prototype,"imageResources",{get:function(){var t=this,r=u.default([this.getImages().map((function(t){return t.getResource()})),this.getContent().map((function(t){return t.getBody()}))]);return s.default(r.map((function(r){switch(r.getProperty("type").toLowerCase()){case o.ExternalResourceType.CHOICE:case o.ExternalResourceType.OA_CHOICE:return new e({images:s.default([r.getProperty("default"),r.getProperty("item")]).map((function(t){return{resource:t}}))},t.options).getImages().map((function(t){return t.getResource()}));default:return r}})))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resourceAnnotations",{get:function(){return u.default([this.getImages(),this.getContent()])},enumerable:!0,configurable:!0}),e.prototype.resourceAnnotation=function(t){return this.resourceAnnotations.find((function(e){return e.getResource().id===t||s.default(new Array(e.getBody())).some((function(e){return e.id===t}))}))},e.prototype.onFragment=function(t){var e=this.resourceAnnotation(t);if(e){var r=e.getProperty("on"),n=e.getProperty("target"),i=(r||n).match(/xywh=(.*)$/);if(i)return i[1].split(",").map((function(t){return parseInt(t,10)}))}},Object.defineProperty(e.prototype,"iiifImageResources",{get:function(){return this.imageResources.filter((function(t){return t&&t.getServices()[0]&&t.getServices()[0].id}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageServiceIds",{get:function(){return this.iiifImageResources.map((function(t){return t.getServices()[0].id}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aspectRatio",{get:function(){return this.getWidth()/this.getHeight()},enumerable:!0,configurable:!0}),e}(a.Resource);e.Canvas=c},function(t,e,r){var n=r(4);t.exports=function(t){return(null==t?0:t.length)?n(t,1):[]}},function(t,e){t.exports=function(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}},function(t,e,r){var n=r(2),i=r(24),o=r(29),a=n?n.isConcatSpreadable:void 0;t.exports=function(t){return o(t)||i(t)||!!(a&&t&&t[a])}},function(t,e,r){var n=r(22),i="object"==typeof self&&self&&self.Object===Object&&self,o=n||i||Function("return this")();t.exports=o},function(t,e,r){(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.exports=r}).call(this,r(23))},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){var n=r(25),i=r(5),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(t){return i(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=u},function(t,e,r){var n=r(26),i=r(5),o="[object Arguments]";t.exports=function(t){return i(t)&&n(t)==o}},function(t,e,r){var n=r(2),i=r(27),o=r(28),a="[object Null]",s="[object Undefined]",u=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?s:a:u&&u in Object(t)?i(t):o(t)}},function(t,e,r){var n=r(2),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=n?n.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),r=t[s];try{t[s]=void 0;var n=!0}catch(t){}var i=a.call(t);return n&&(e?t[s]=r:delete t[s]),i}},function(t,e){var r=Object.prototype.toString;t.exports=function(t){return r.call(t)}},function(t,e){var r=Array.isArray;t.exports=r},function(t,e,r){var n=r(4),i=1/0;t.exports=function(t){return(null==t?0:t.length)?n(t,i):[]}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=r(1),o=r(32),a=function(){function t(t,e,r){void 0===r&&(r=i.ViewingDirection.LEFT_TO_RIGHT),this.canvases=t,this.layers=e,this.viewingDirection=r}return Object.defineProperty(t.prototype,"canvasIds",{get:function(){return this.canvases.map((function(t){return t.id}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvasDimensions",{get:function(){if(this._canvasDimensions)return this._canvasDimensions;var t=this.canvasDirection,e=t[0],r=t[1],i=0===r?Math.min.apply(Math,this.canvases.map((function(t){return t.getHeight()}))):Math.min.apply(Math,this.canvases.map((function(t){return t.getWidth()}))),o=0,a=0,s=this.canvases.reduce((function(t,n){var s=0,u=0;return isNaN(n.aspectRatio)||(0===r?(s=i,u=Math.floor(i*n.aspectRatio)):(u=i,s=Math.floor(i*(1/n.aspectRatio)))),t.push({canvas:n,height:s,width:u,x:o,y:a}),o+=e*u,a+=r*s,t}),[]),u=0===r?i:Math.abs(a),c=0===e?i:Math.abs(o);return this._canvasDimensions=s.reduce((function(t,i){return t.push(n(n({},i),{x:-1===e?i.x+c-i.width:i.x,y:-1===r?i.y+u-i.height:i.y})),t}),[]),this._canvasDimensions},enumerable:!0,configurable:!0}),t.prototype.contentResourceToWorldCoordinates=function(t){var e=this.canvases.findIndex((function(e){return e.imageResources.find((function(e){return e.id===t.id}))})),r=this.canvases[e];if(!r)return[];var n=this.canvasToWorldCoordinates(r.id),i=n[0],o=n[1],a=n[2],s=n[3],u=r.onFragment(t.id);return u?[i+u[0],o+u[1],u[2],u[3]]:[i,o,a,s]},t.prototype.canvasToWorldCoordinates=function(t){var e=this.canvasDimensions.find((function(e){return e.canvas.id===t}));return[e.x,e.y,e.width,e.height]},Object.defineProperty(t.prototype,"canvasDirection",{get:function(){switch(this.viewingDirection){case i.ViewingDirection.LEFT_TO_RIGHT:return[1,0];case i.ViewingDirection.RIGHT_TO_LEFT:return[-1,0];case i.ViewingDirection.TOP_TO_BOTTOM:return[0,1];case i.ViewingDirection.BOTTOM_TO_TOP:return[0,-1];default:return[1,0]}},enumerable:!0,configurable:!0}),t.prototype.contentResource=function(t){var e=this.canvases.find((function(e){return e.imageServiceIds.some((function(e){return o.default(e,{stripAuthentication:!1})===o.default(t,{stripAuthentication:!1})}))}));if(e)return e.imageResources.find((function(e){return o.default(e.getServices()[0].id,{stripAuthentication:!1})===o.default(t,{stripAuthentication:!1})}))},t.prototype.getLayerMetadata=function(t){if(this.layers){var e=this.canvases.find((function(e){return e.imageResources.find((function(e){return e.id===t.id}))}));if(e){var r=e.imageResources.findIndex((function(e){return e.id===t.id})),i=this.layers[e.id],o=i&&i[t.id];return n({index:r,opacity:1,total:e.imageResources.length,visibility:!0},o)}}},t.prototype.layerOpacityOfImageResource=function(t){var e=this.getLayerMetadata(t);return e?e.visibility?e.opacity:0:1},t.prototype.layerIndexOfImageResource=function(t){var e=this.getLayerMetadata(t);if(e)return e.total-e.index-1},t.prototype.offsetByCanvas=function(t){var e=this.canvasToWorldCoordinates(t);return{x:e[0],y:e[1]}},t.prototype.worldBounds=function(){return[0,0,Math.max.apply(Math,this.canvasDimensions.map((function(t){return t.x+t.width}))),Math.max.apply(Math,this.canvasDimensions.map((function(t){return t.y+t.height})))]},t.prototype.canvasAtPoint=function(t){var e=this.canvasDimensions.find((function(e){return e.x<=t.x&&t.x<=e.x+e.width&&e.y<=t.y&&t.y<=e.y+e.height}));return e&&e.canvas},t}();e.CanvasWorld=a},function(t,e,r){"use strict";const n=(t,e)=>e.some(e=>e instanceof RegExp?e.test(t):e===t);t.exports=(t,e)=>{if(e={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...e},t=t.trim(),/^data:/i.test(t))return((t,{stripHash:e})=>{const r=/^data:(?<type>.*?),(?<data>.*?)(?:#(?<hash>.*))?$/.exec(t);if(!r)throw new Error(`Invalid URL: ${t}`);let{type:n,data:i,hash:o}=r.groups;const a=n.split(";");o=e?"":o;let s=!1;"base64"===a[a.length-1]&&(a.pop(),s=!0);const u=(a.shift()||"").toLowerCase(),c=[...a.map(t=>{let[e,r=""]=t.split("=").map(t=>t.trim());return"charset"===e&&"us-ascii"===(r=r.toLowerCase())?"":`${e}${r?`=${r}`:""}`}).filter(Boolean)];return s&&c.push("base64"),(0!==c.length||u&&"text/plain"!==u)&&c.unshift(u),`data:${c.join(";")},${s?i.trim():i}${o?`#${o}`:""}`})(t,e);if(/^view-source:/i.test(t))throw new Error("`view-source:` is not supported as it is a non-standard protocol");const r=t.startsWith("//");!r&&/^\.*\//.test(t)||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));const i=new URL(t);if(e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&"https:"===i.protocol&&(i.protocol="http:"),e.forceHttps&&"http:"===i.protocol&&(i.protocol="https:"),e.stripAuthentication&&(i.username="",i.password=""),e.stripHash&&(i.hash=""),i.pathname&&(i.pathname=i.pathname.replace(/(?<!\b(?:[a-z][a-z\d+\-.]{1,50}:))\/{2,}/g,"/")),i.pathname)try{i.pathname=decodeURI(i.pathname)}catch(t){}if(!0===e.removeDirectoryIndex&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let t=i.pathname.split("/");const r=t[t.length-1];n(r,e.removeDirectoryIndex)&&(t=t.slice(0,t.length-1),i.pathname=t.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)(?:[a-z\-\d]{1,63})\.(?:[a-z.\-\d]{2,63})$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(const t of[...i.searchParams.keys()])n(t,e.removeQueryParameters)&&i.searchParams.delete(t);e.sortQueryParameters&&i.searchParams.sort(),e.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));const o=t;return t=i.toString(),e.removeSingleSlash||"/"!==i.pathname||o.endsWith("/")||""!==i.hash||(t=t.replace(/\/$/,"")),(e.removeTrailingSlash||"/"===i.pathname)&&""===i.hash&&e.removeSingleSlash&&(t=t.replace(/\/$/,"")),r&&!e.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),e.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(0),s=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.items=[],n._collections=null,n._manifests=null,e.__collection=n,n}return i(e,t),e.prototype.getCollections=function(){return this._collections?this._collections:this._collections=this.items.filter((function(t){return t.isCollection()}))},e.prototype.getManifests=function(){return this._manifests?this._manifests:this._manifests=this.items.filter((function(t){return t.isManifest()}))},e.prototype.getCollectionByIndex=function(t){for(var e,r=this.getCollections(),n=0;n<r.length;n++){var i=r[n];i.index===t&&(e=i)}if(e)return e.options.index=t,e.load();throw new Error("Collection index not found")},e.prototype.getManifestByIndex=function(t){for(var e,r=this.getManifests(),n=0;n<r.length;n++){var i=r[n];i.index===t&&(e=i)}if(e)return e.options.index=t,e.load();throw new Error("Manifest index not found")},e.prototype.getTotalCollections=function(){return this.getCollections().length},e.prototype.getTotalManifests=function(){return this.getManifests().length},e.prototype.getTotalItems=function(){return this.items.length},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):o.ViewingDirection.LEFT_TO_RIGHT},e.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e.prototype.getDefaultTree=function(){return t.prototype.getDefaultTree.call(this),this.defaultTree.data.type=a.Utils.normaliseType(a.TreeNodeType.COLLECTION),this._parseManifests(this),this._parseCollections(this),a.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},e.prototype._parseManifests=function(t){if(t.getManifests()&&t.getManifests().length)for(var e=0;e<t.getManifests().length;e++){var r=t.getManifests()[e],n=r.getDefaultTree();n.label=r.parentLabel||r.getLabel().getValue(this.options.locale)||"manifest "+(e+1),n.navDate=r.getNavDate(),n.data.id=r.id,n.data.type=a.Utils.normaliseType(a.TreeNodeType.MANIFEST),t.defaultTree.addNode(n)}},e.prototype._parseCollections=function(t){if(t.getCollections()&&t.getCollections().length)for(var e=0;e<t.getCollections().length;e++){var r=t.getCollections()[e],n=r.getDefaultTree();n.label=r.parentLabel||r.getLabel().getValue(this.options.locale)||"collection "+(e+1),n.navDate=r.getNavDate(),n.data.id=r.id,n.data.type=a.Utils.normaliseType(a.TreeNodeType.COLLECTION),t.defaultTree.addNode(n)}},e}(a.IIIFResource);e.Collection=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.start=t,this.end=e}return t.prototype.getLength=function(){return this.end-this.start},t}();e.Duration=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=function(){function t(t){this.defaultLocale=t}return t.prototype.parse=function(t){this.resource=t,this.label=n.PropertyValue.parse(this.resource.label,this.defaultLocale),this.value=n.PropertyValue.parse(this.resource.value,this.defaultLocale)},t.prototype.getLabel=function(t){return null===this.label?null:(Array.isArray(t)&&!t.length&&(t=void 0),this.label.getValue(t||this.defaultLocale))},t.prototype.setLabel=function(t){null===this.label&&(this.label=new n.PropertyValue([])),this.label.setValue(t,this.defaultLocale)},t.prototype.getValue=function(t,e){return void 0===e&&(e="<br/>"),null===this.value?null:(Array.isArray(t)&&!t.length&&(t=void 0),this.value.getValue(t||this.defaultLocale,e))},t.prototype.getValues=function(t){return null===this.value?[]:(Array.isArray(t)&&!t.length&&(t=void 0),this.value.getValues(t||this.defaultLocale))},t.prototype.setValue=function(t){null===this.value&&(this.value=new n.PropertyValue([])),this.value.setValue(t,this.defaultLocale)},t}();e.LabelValuePair=i},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.getValue=function(t,e){return t.getValue(e,"<br/>")},e.getValues=function(t,e){return t.getValues(e)},e}(Array);e.LanguageMap=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n};Object.defineProperty(e,"__esModule",{value:!0});var a=r(3),s=function(){function t(t,e,r){void 0===r&&(r="none"),Array.isArray(t)&&1===t.length?this._value=t[0]:this._value=t,"none"!==e&&"@none"!==e||(e=void 0),this._locale=e,this._defaultLocale=r}return t.parseV2Value=function(e,r){return"string"==typeof e?new t(e,void 0,r):e["@value"]?new t(e["@value"],e["@language"],r):null},Object.defineProperty(t.prototype,"value",{get:function(){return Array.isArray(this._value)?this._value.join("<br/>"):this._value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"locale",{get:function(){return void 0===this._locale?this._defaultLocale:this._locale},enumerable:!0,configurable:!0}),t.prototype.addValue=function(t){Array.isArray(this._value)||(this._value=[this._value]),Array.isArray(t)?this._value=this._value.concat(t):this._value.push(t)},t}();e.LocalizedValue=s;var u=function(t){function e(r,n){void 0===r&&(r=[]);var i=t.apply(this,r)||this;return i.__proto__=e.prototype,i._defaultLocale=n,i}return i(e,t),e.parse=function(t,r){if(!t)return new e([],r);if(Array.isArray(t)){var n=(i=t.map((function(t){return s.parseV2Value(t,r)})).filter((function(t){return null!==t}))).reduce((function(t,e){var r=e._locale;return r||(r="none"),t[r]?t[r].addValue(e._value):t[r]=e,t}),{});return new e(Object.values(n),r)}return"string"==typeof t?new e([new s(t,void 0,r)],r):t["@language"]?new e(null!==(i=s.parseV2Value(t))?[i]:[],r):new e(Object.keys(t).map((function(e){var n=t[e];if(!Array.isArray(n))throw new Error("A IIIF v3 localized property value must have an array as the value for a given language.");return new s(n,e,r)})),r);var i},e.prototype.getSuitableLocale=function(t){for(var e=o(this).map((function(t){return t._locale})).filter((function(t){return void 0!==t})),r=function(t){var r=e.find((function(e){return e===t}));if(r)return{value:r}},n=0,i=t;n<i.length;n++){var s=r(i[n]);if("object"==typeof s)return s.value}for(var u=function(t){var r=e.find((function(e){return a.Utils.getInexactLocale(e)===a.Utils.getInexactLocale(t)}));if(r)return{value:r}},c=0,l=t;c<l.length;c++){var p=u(l[c]);if("object"==typeof p)return p.value}},e.prototype.setValue=function(t,e){var r=void 0;if(e){var n=this.getSuitableLocale([e]);n&&(r=this.find((function(t){return t._locale===n})))}else r=this.find((function(t){return void 0===t._locale}));r?r._value=t:this.push(new s(t,e,this._defaultLocale))},e.prototype.getValue=function(t,e){var r=this.getValues(t);return 0===r.length?null:e?r.join(e):r[0]},e.prototype.getValues=function(t){if(!this.length)return[];var e;if(e=t?Array.isArray(t)?t:[t]:[],1===this.length&&void 0===this[0]._locale){var r=this[0]._value;return Array.isArray(r)?r:[r]}var n=this.getSuitableLocale(e);if(n){r=this.find((function(t){return t._locale===n}))._value;return Array.isArray(r)?r:[r]}if(!this.find((function(t){return void 0===t._locale}))){r=this[0]._value;return Array.isArray(r)?r:[r]}var i=this.find((function(t){return void 0===t._locale}));return i?Array.isArray(i._value)?i._value:[i._value]:[]},e}(Array);e.PropertyValue=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONTINUE=100,e.SWITCHING_PROTOCOLS=101,e.PROCESSING=102,e.OK=200,e.CREATED=201,e.ACCEPTED=202,e.NON_AUTHORITATIVE_INFORMATION=203,e.NO_CONTENT=204,e.RESET_CONTENT=205,e.PARTIAL_CONTENT=206,e.MULTI_STATUS=207,e.MULTIPLE_CHOICES=300,e.MOVED_PERMANENTLY=301,e.MOVED_TEMPORARILY=302,e.SEE_OTHER=303,e.NOT_MODIFIED=304,e.USE_PROXY=305,e.TEMPORARY_REDIRECT=307,e.BAD_REQUEST=400,e.UNAUTHORIZED=401,e.PAYMENT_REQUIRED=402,e.FORBIDDEN=403,e.NOT_FOUND=404,e.METHOD_NOT_ALLOWED=405,e.NOT_ACCEPTABLE=406,e.PROXY_AUTHENTICATION_REQUIRED=407,e.REQUEST_TIME_OUT=408,e.CONFLICT=409,e.GONE=410,e.LENGTH_REQUIRED=411,e.PRECONDITION_FAILED=412,e.REQUEST_ENTITY_TOO_LARGE=413,e.REQUEST_URI_TOO_LARGE=414,e.UNSUPPORTED_MEDIA_TYPE=415,e.REQUESTED_RANGE_NOT_SATISFIABLE=416,e.EXPECTATION_FAILED=417,e.IM_A_TEAPOT=418,e.UNPROCESSABLE_ENTITY=422,e.LOCKED=423,e.FAILED_DEPENDENCY=424,e.UNORDERED_COLLECTION=425,e.UPGRADE_REQUIRED=426,e.PRECONDITION_REQUIRED=428,e.TOO_MANY_REQUESTS=429,e.REQUEST_HEADER_FIELDS_TOO_LARGE=431,e.INTERNAL_SERVER_ERROR=500,e.NOT_IMPLEMENTED=501,e.BAD_GATEWAY=502,e.SERVICE_UNAVAILABLE=503,e.GATEWAY_TIME_OUT=504,e.HTTP_VERSION_NOT_SUPPORTED=505,e.VARIANT_ALSO_NEGOTIATES=506,e.INSUFFICIENT_STORAGE=507,e.BANDWIDTH_LIMIT_EXCEEDED=509,e.NOT_EXTENDED=510,e.NETWORK_AUTHENTICATION_REQUIRED=511},function(t,e,r){t.exports=window.fetch||(window.fetch=r(6).default||r(6))},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(0),s=function(t){function e(e,r){var n=t.call(this,e,r)||this;if(n.index=0,n._allRanges=null,n.items=[],n._topRanges=[],n.__jsonld.structures&&n.__jsonld.structures.length)for(var i=n._getTopRanges(),o=0;o<i.length;o++){var a=i[o];n._parseRanges(a,String(o))}return n}return i(e,t),e.prototype.getPosterCanvas=function(){var t=this.getProperty("posterCanvas");return t&&(t=new a.Canvas(t,this.options)),t},e.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},e.prototype.getDefaultTree=function(){if(t.prototype.getDefaultTree.call(this),this.defaultTree.data.type=a.Utils.normaliseType(a.TreeNodeType.MANIFEST),!this.isLoaded)return this.defaultTree;var e=this.getTopRanges();return e.length&&e[0].getTree(this.defaultTree),a.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},e.prototype._getTopRanges=function(){var t=[];if(this.__jsonld.structures&&this.__jsonld.structures.length){for(var e=0;e<this.__jsonld.structures.length;e++){var r=this.__jsonld.structures[e];r.viewingHint===o.ViewingHint.TOP&&t.push(r)}if(!t.length){var n={};n.ranges=this.__jsonld.structures,t.push(n)}}return t},e.prototype.getTopRanges=function(){return this._topRanges},e.prototype._getRangeById=function(t){if(this.__jsonld.structures&&this.__jsonld.structures.length)for(var e=0;e<this.__jsonld.structures.length;e++){var r=this.__jsonld.structures[e];if(r["@id"]===t||r.id===t)return r}return null},e.prototype._parseRanges=function(t,e,r){var n,i=null;if("string"==typeof t&&(i=t,t=this._getRangeById(i)),t){(n=new a.Range(t,this.options)).parentRange=r,n.path=e,r?r.items.push(n):this._topRanges.push(n);var o=t.items||t.members;if(o)for(var s=0;s<o.length;s++){var u=o[s];if(u["@type"]&&"sc:range"===u["@type"].toLowerCase()||u.type&&"range"===u.type.toLowerCase())this._parseRanges(u,e+"/"+s,n);else if(u["@type"]&&"sc:canvas"===u["@type"].toLowerCase()||u.type&&"canvas"===u.type.toLowerCase()){n.canvases||(n.canvases=[]);var c=u.id||u["@id"];n.canvases.push(c)}}else if(t.ranges)for(s=0;s<t.ranges.length;s++)this._parseRanges(t.ranges[s],e+"/"+s,n)}else console.warn("Range:",i,"does not exist")},e.prototype.getAllRanges=function(){if(null!=this._allRanges)return this._allRanges;this._allRanges=[];for(var t=this.getTopRanges(),e=function(e){var n=t[e];n.id&&r._allRanges.push(n);var i=function(t,e){t.add(e);var r=e.getRanges();return r.length?r.reduce(i,t):t},o=Array.from(n.getRanges().reduce(i,new Set));r._allRanges=r._allRanges.concat(o)},r=this,n=0;n<t.length;n++)e(n);return this._allRanges},e.prototype.getRangeById=function(t){for(var e=this.getAllRanges(),r=0;r<e.length;r++){var n=e[r];if(n.id===t)return n}return null},e.prototype.getRangeByPath=function(t){for(var e=this.getAllRanges(),r=0;r<e.length;r++){var n=e[r];if(n.path===t)return n}return null},e.prototype.getSequences=function(){if(this.items.length)return this.items;var t=this.__jsonld.mediaSequences||this.__jsonld.sequences;if(t)for(var e=0;e<t.length;e++){var r=t[e],n=new a.Sequence(r,this.options);this.items.push(n)}else if(this.__jsonld.items){n=new a.Sequence(this.__jsonld.items,this.options);this.items.push(n)}return this.items},e.prototype.getSequenceByIndex=function(t){return this.getSequences()[t]},e.prototype.getTotalSequences=function(){return this.getSequences().length},e.prototype.getManifestType=function(){var t=this.getService(o.ServiceProfile.UI_EXTENSIONS);return t?t.getProperty("manifestType"):a.ManifestType.EMPTY},e.prototype.isMultiSequence=function(){return this.getTotalSequences()>1},e.prototype.isPagingEnabled=function(){var t=this.getViewingHint();if(t)return t===o.ViewingHint.PAGED;var e=this.getBehavior();return!!e&&e===o.Behavior.PAGED},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e}(a.IIIFResource);e.Manifest=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.EMPTY="",t.MANUSCRIPT="manuscript",t.MONOGRAPH="monograph"}(e.ManifestType||(e.ManifestType={}))},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=r(1),s=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n._ranges=null,n.canvases=null,n.items=[],n}return i(e,t),e.prototype.getCanvasIds=function(){return this.__jsonld.canvases?this.__jsonld.canvases:this.canvases?this.canvases:[]},e.prototype.getDuration=function(){if(this.canvases&&this.canvases.length){for(var t=[],e=[],r=0,n=this.canvases;r<n.length;r++){if(_=n[r]){var i=_.match(/(.*)#t=([0-9.]+),?([0-9.]+)?/)||[void 0,_],a=i[1],s=i[2],u=i[3];a&&(t.push(parseFloat(s)),e.push(parseFloat(u)))}}if(t.length&&e.length)return new o.Duration(Math.min.apply(Math,t),Math.max.apply(Math,e))}else{t=[],e=[];for(var c=0,l=d=this.getRanges();c<l.length;c++){(v=l[c].getDuration())&&(t.push(v.start),e.push(v.end))}if(t.length&&e.length)return new o.Duration(Math.min.apply(Math,t),Math.max.apply(Math,e))}var p,f;if(this.canvases&&this.canvases.length)for(var h=0;h<this.canvases.length;h++){var _=this.canvases[h],g=o.Utils.getTemporalComponent(_);g&&g.length>1&&(0===h&&(p=Number(g[0])),h===this.canvases.length-1&&(f=Number(g[1])))}else{var d=this.getRanges();for(h=0;h<d.length;h++){var v;(v=d[h].getDuration())&&(0===h&&(p=v.start),h===d.length-1&&(f=v.end))}}if(void 0!==p&&void 0!==f)return new o.Duration(p,f)},e.prototype.getRanges=function(){return this._ranges?this._ranges:this._ranges=this.items.filter((function(t){return t.isRange()}))},e.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e.prototype.getTree=function(t){t.data=this,this.treeNode=t;var e=this.getRanges();if(e&&e.length)for(var r=0;r<e.length;r++){var n=e[r],i=new o.TreeNode;t.addNode(i),this._parseTreeNode(i,n)}return o.Utils.generateTreeNodeIds(t),t},e.prototype.spansTime=function(t){var e=this.getDuration();return!!(e&&t>=e.start&&t<=e.end)},e.prototype._parseTreeNode=function(t,e){t.label=e.getLabel().getValue(this.options.locale),t.data=e,t.data.type=o.Utils.normaliseType(o.TreeNodeType.RANGE),e.treeNode=t;var r=e.getRanges();if(r&&r.length)for(var n=0;n<r.length;n++){var i=r[n];if(i.getBehavior()!==a.Behavior.NO_NAV){var s=new o.TreeNode;t.addNode(s),this._parseTreeNode(s,i)}}},e}(o.ManifestResource);e.Range=s},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,r){return t.call(this,e,r)||this}return i(e,t),e.prototype.getFormat=function(){return this.getProperty("format")},e}(r(0).ManifestResource);e.Rendering=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(0),s=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.items=[],n._thumbnails=null,n}return i(e,t),e.prototype.getCanvases=function(){if(this.items.length)return this.items;var t=this.__jsonld.canvases||this.__jsonld.elements;if(t)for(var e=0;e<t.length;e++){var r=t[e];(n=new a.Canvas(r,this.options)).index=e,this.items.push(n)}else if(this.__jsonld)for(e=0;e<this.__jsonld.length;e++){var n;r=this.__jsonld[e];(n=new a.Canvas(r,this.options)).index=e,this.items.push(n)}return this.items},e.prototype.getCanvasById=function(t){for(var e=0;e<this.getTotalCanvases();e++){var r=this.getCanvasByIndex(e),n=a.Utils.normaliseUrl(r.id);if(a.Utils.normaliseUrl(t)===n)return r}return null},e.prototype.getCanvasByIndex=function(t){return this.getCanvases()[t]},e.prototype.getCanvasIndexById=function(t){for(var e=0;e<this.getTotalCanvases();e++){if(this.getCanvasByIndex(e).id===t)return e}return null},e.prototype.getCanvasIndexByLabel=function(t,e){t=t.trim(),isNaN(t)||(t=parseInt(t,10).toString(),e&&(t+="r"));for(var r,n,i,o=/(\d*)\D+(\d*)/,a=0;a<this.getTotalCanvases();a++){var s=this.getCanvasByIndex(a);if(s.getLabel().getValue(this.options.locale)===t)return a;if((r=o.exec(t))&&(n=r[1],(i=r[2])&&new RegExp("^"+n+"\\D+"+i+"$").test(s.getLabel().toString())))return a}return-1},e.prototype.getLastCanvasLabel=function(t){for(var e=this.getTotalCanvases()-1;e>=0;e--){var r=this.getCanvasByIndex(e).getLabel().getValue(this.options.locale);if(t){if(/^[a-zA-Z0-9]*$/.test(r))return r}else if(r)return r}return this.options.defaultLabel},e.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},e.prototype.getNextPageIndex=function(t,e){var r;if(e){var n=this.getPagedIndices(t),i=this.getViewingDirection();r=i&&i===o.ViewingDirection.RIGHT_TO_LEFT?n[0]+1:n[n.length-1]+1}else r=t+1;return r>this.getLastPageIndex()?-1:r},e.prototype.getPagedIndices=function(t,e){var r=[];if(e){r=this.isFirstCanvas(t)||this.isLastCanvas(t)?[t]:t%2?[t,t+1]:[t-1,t];var n=this.getViewingDirection();n&&n===o.ViewingDirection.RIGHT_TO_LEFT&&(r=r.reverse())}else r.push(t);return r},e.prototype.getPrevPageIndex=function(t,e){var r;if(e){var n=this.getPagedIndices(t),i=this.getViewingDirection();r=i&&i===o.ViewingDirection.RIGHT_TO_LEFT?n[n.length-1]-1:n[0]-1}else r=t-1;return r},e.prototype.getStartCanvasIndex=function(){var t=this.getStartCanvas();if(t)for(var e=0;e<this.getTotalCanvases();e++){if(this.getCanvasByIndex(e).id===t)return e}return 0},e.prototype.getThumbs=function(t,e){for(var r=[],n=this.getTotalCanvases(),i=0;i<n;i++){var o=this.getCanvasByIndex(i),s=new a.Thumb(t,o);r.push(s)}return r},e.prototype.getThumbnails=function(){if(null!=this._thumbnails)return this._thumbnails;this._thumbnails=[];for(var t=this.getCanvases(),e=0;e<t.length;e++){var r=t[e].getThumbnail();r&&this._thumbnails.push(r)}return this._thumbnails},e.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},e.prototype.getTotalCanvases=function(){return this.getCanvases().length},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):this.options.resource.getViewingDirection()?this.options.resource.getViewingDirection():null},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e.prototype.isCanvasIndexOutOfRange=function(t){return t>this.getTotalCanvases()-1},e.prototype.isFirstCanvas=function(t){return 0===t},e.prototype.isLastCanvas=function(t){return t===this.getTotalCanvases()-1},e.prototype.isMultiCanvas=function(){return this.getTotalCanvases()>1},e.prototype.isPagingEnabled=function(){var t=this.getViewingHint();return!!t&&t===o.ViewingHint.PAGED},e.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2==0},e}(a.ManifestResource);e.Sequence=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=function(){function t(){}return t.parse=function(t,e){return"string"==typeof t&&(t=JSON.parse(t)),this.parseJson(t,e)},t.parseJson=function(t,e){var r;if(e&&e.navDate&&!isNaN(e.navDate.getTime())&&(t.navDate=e.navDate.toString()),t["@type"])switch(t["@type"]){case"sc:Collection":r=this.parseCollection(t,e);break;case"sc:Manifest":r=this.parseManifest(t,e);break;default:return null}else switch(t.type){case"Collection":r=this.parseCollection(t,e);break;case"Manifest":r=this.parseManifest(t,e);break;default:return null}return r.isLoaded=!0,r},t.parseCollection=function(t,e){var r=new n.Collection(t,e);return e?(r.index=e.index||0,e.resource&&(r.parentCollection=e.resource.parentCollection)):r.index=0,this.parseCollections(r,e),this.parseManifests(r,e),this.parseItems(r,e),r},t.parseCollections=function(t,e){var r;if(t.__jsonld.collections?r=t.__jsonld.collections:t.__jsonld.items&&(r=t.__jsonld.items.filter((function(t){return"collection"===t.type.toLowerCase()}))),r)for(var n=0;n<r.length;n++){e&&(e.index=n);var i=this.parseCollection(r[n],e);i.index=n,i.parentCollection=t,t.items.push(i)}},t.parseManifest=function(t,e){return new n.Manifest(t,e)},t.parseManifests=function(t,e){var r;if(t.__jsonld.manifests?r=t.__jsonld.manifests:t.__jsonld.items&&(r=t.__jsonld.items.filter((function(t){return"manifest"===t.type.toLowerCase()}))),r)for(var n=0;n<r.length;n++){var i=this.parseManifest(r[n],e);i.index=n,i.parentCollection=t,t.items.push(i)}},t.parseItem=function(t,e){if(t["@type"]){if("sc:manifest"===t["@type"].toLowerCase())return this.parseManifest(t,e);if("sc:collection"===t["@type"].toLowerCase())return this.parseCollection(t,e)}else if(t.type){if("manifest"===t.type.toLowerCase())return this.parseManifest(t,e);if("collection"===t.type.toLowerCase())return this.parseCollection(t,e)}return null},t.parseItems=function(t,e){var r=t.__jsonld.members||t.__jsonld.items;if(r)for(var n=function(n){e&&(e.index=n);var o=i.parseItem(r[n],e);return o?t.items.filter((function(t){return t.id===o.id}))[0]?"continue":(o.index=n,o.parentCollection=t,void t.items.push(o)):{value:void 0}},i=this,o=0;o<r.length;o++){var a=n(o);if("object"==typeof a)return a.value}},t}();e.Deserialiser=i},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=function(t){function e(e,r){return t.call(this,e,r)||this}return i(e,t),e.prototype.getProfile=function(){var t=this.getProperty("profile");return t||(t=this.getProperty("dcterms:conformsTo")),Array.isArray(t)?t[0]:t},e.prototype.getConfirmLabel=function(){return o.Utils.getLocalisedValue(this.getProperty("confirmLabel"),this.options.locale)},e.prototype.getDescription=function(){return o.Utils.getLocalisedValue(this.getProperty("description"),this.options.locale)},e.prototype.getFailureDescription=function(){return o.Utils.getLocalisedValue(this.getProperty("failureDescription"),this.options.locale)},e.prototype.getFailureHeader=function(){return o.Utils.getLocalisedValue(this.getProperty("failureHeader"),this.options.locale)},e.prototype.getHeader=function(){return o.Utils.getLocalisedValue(this.getProperty("header"),this.options.locale)},e.prototype.getServiceLabel=function(){return o.Utils.getLocalisedValue(this.getProperty("label"),this.options.locale)},e.prototype.getInfoUri=function(){var t=this.id;return t.endsWith("/")||(t+="/"),t+="info.json"},e}(o.ManifestResource);e.Service=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e){this.width=t,this.height=e};e.Size=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.AUTHORIZATION_FAILED=1]="AUTHORIZATION_FAILED",t[t.FORBIDDEN=2]="FORBIDDEN",t[t.INTERNAL_SERVER_ERROR=3]="INTERNAL_SERVER_ERROR",t[t.RESTRICTED=4]="RESTRICTED"}(e.StatusCode||(e.StatusCode={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e){this.data=e,this.index=e.index,this.width=t;var r=e.getHeight()/e.getWidth();this.height=r?Math.floor(this.width*r):t,this.uri=e.getCanonicalImageUri(t),this.label=e.getLabel().getValue()};e.Thumb=n},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,r){return t.call(this,e,r)||this}return i(e,t),e}(r(0).Resource);e.Thumbnail=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=function(){function t(t,e){this.label=t,this.data=e||{},this.nodes=[]}return t.prototype.addNode=function(t){this.nodes.push(t),t.parentNode=this},t.prototype.isCollection=function(){return this.data.type===n.Utils.normaliseType(n.TreeNodeType.COLLECTION)},t.prototype.isManifest=function(){return this.data.type===n.Utils.normaliseType(n.TreeNodeType.MANIFEST)},t.prototype.isRange=function(){return this.data.type===n.Utils.normaliseType(n.TreeNodeType.RANGE)},t}();e.TreeNode=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.COLLECTION="collection",t.MANIFEST="manifest",t.RANGE="range"}(e.TreeNodeType||(e.TreeNodeType={}))}]);